{"ast":null,"code":"import _asyncToGenerator from\"C:/Users/bilal/Documents/food-delivery-app/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/bilal/Documents/food-delivery-app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\bilal\\\\Documents\\\\food-delivery-app\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import axios from'axios';import React,{useEffect,useState,useContext}from'react';import Navbar from'../../components/navbar/Navbar';import LoadingSpinner from'../../components/spinner/Spinner';import{Notyf}from'notyf';import'notyf/notyf.min.css';import{StatusContext}from'../../components/context/StatusContext';import\"./myorder.css\";import Status from'../../components/status/Status';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function MyOrders(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),myOrders=_useState2[0],setMyOrders=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];var statusTab=[\"Waiting confirmation...\",\"cooking...\",\"On the way...\",\"Delivered\"];var _useContext=useContext(StatusContext),sock=_useContext.sock;console.log(sock);//Permet de montrer/cacher les éléments de la commande (nourriture) lors du clique\nvar showHideFood=function showHideFood(e,id){e.preventDefault();document.getElementById(id).classList.toggle(\"show-hide\");};// pour status faire un composant a part avec des props\n// faire un useeffect dans ce composant pour mettre à jour le status\n// ou \nuseEffect(function(){if(!sock){return;}sock.on(\"recieve-status\",function(state){setMyOrders(function(orders){return orders.map(function(order){if(order._id===state._id){return state;}return order;});});});},[sock]);useEffect(function(){var id=localStorage.getItem(\"userId\");var getOrder=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios({method:\"get\",url:\"\".concat(process.env.REACT_APP_API_URL,\"order/\")+id,withCredentials:true,headers:{'Access-Control-Allow-Credentials':true}}).then(function(res){console.log(res.data.data);setMyOrders(res.data.data);setTimeout(function(){return setLoading(true);},500);}).catch(function(err){console.log(err);});case 2:case\"end\":return _context.stop();}}},_callee);}));return function getOrder(){return _ref.apply(this,arguments);};}();getOrder();},[]);if(loading===false){return/*#__PURE__*/_jsx(LoadingSpinner,{});}return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"orders-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"current-orders orders\",children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"title-order\",children:[\"  \",/*#__PURE__*/_jsx(\"span\",{className:\"span-color\",children:\"Current\"}),\" Orders\"]}),myOrders.length===0?/*#__PURE__*/_jsx(\"p\",{children:\"You don't have any current order \"}):myOrders.map(function(order){var date=new Date(order.createdAt);if(order.status!==3){return/*#__PURE__*/_jsxs(\"div\",{className:\"single-order\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"status-order-current\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"status\",children:\"Status : \"}),\" \",statusTab[order.status]]}),/*#__PURE__*/_jsx(\"p\",{className:\"date-order\",children:date.toLocaleDateString(\"fr\")}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Address : \",order.address]}),/*#__PURE__*/_jsx(\"button\",{className:\"show-food\",onClick:function onClick(e){return showHideFood(e,order._id);},children:\"Show/hide food\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"food-list\",id:order._id,children:order.orderItems.map(function(item){return/*#__PURE__*/_jsxs(\"li\",{children:[\" \",/*#__PURE__*/_jsx(\"img\",{src:process.env.PUBLIC_URL+\"/image/\".concat(item.name,\".png\"),alt:\"\",width:\"40\",height:\"40\"}),\" \",/*#__PURE__*/_jsx(\"span\",{children:item.name}),\" \",/*#__PURE__*/_jsxs(\"span\",{children:[\"$\",item.price]})]});})}),/*#__PURE__*/_jsxs(\"p\",{className:\"total-order-price\",children:[\"Total : \",/*#__PURE__*/_jsx(\"span\",{className:\"span-color\",children:\"$\"}),order.total]})]});}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"old-orders orders\",children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"title-order\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"span-color\",children:\"Old\"}),\" Orders\"]}),myOrders.map(function(order){var date=new Date(order.createdAt);if(order.status===3){return/*#__PURE__*/_jsxs(\"div\",{className:\"single-order\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"status-order-old\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"status\",children:\"Status :\"}),\"  \",statusTab[order.status]]}),/*#__PURE__*/_jsx(\"p\",{className:\"date-order\",children:date.toLocaleDateString(\"fr\")}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Address : \",order.address]}),/*#__PURE__*/_jsx(\"button\",{className:\"show-food\",onClick:function onClick(e){return showHideFood(e,order._id);},children:\"Show/hide food\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"food-list\",id:order._id,children:order.orderItems.map(function(item){return/*#__PURE__*/_jsxs(\"li\",{children:[\" \",/*#__PURE__*/_jsx(\"img\",{src:process.env.PUBLIC_URL+\"/image/\".concat(item.name,\".png\"),alt:\"\",width:\"40\",height:\"40\"}),\" \",/*#__PURE__*/_jsx(\"span\",{children:item.name}),\" \",/*#__PURE__*/_jsxs(\"span\",{children:[\"$\",item.price]})]});})}),/*#__PURE__*/_jsxs(\"p\",{className:\"total-order-price\",children:[\"Total : \",/*#__PURE__*/_jsx(\"span\",{className:\"span-color\",children:\"$\"}),order.total]})]});}})]})]})]});}","map":{"version":3,"sources":["C:/Users/bilal/Documents/food-delivery-app/client/src/pages/myOrder/MyOrders.js"],"names":["axios","React","useEffect","useState","useContext","Navbar","LoadingSpinner","Notyf","StatusContext","Status","MyOrders","myOrders","setMyOrders","loading","setLoading","statusTab","sock","console","log","showHideFood","e","id","preventDefault","document","getElementById","classList","toggle","on","state","orders","map","order","_id","localStorage","getItem","getOrder","method","url","process","env","REACT_APP_API_URL","withCredentials","headers","then","res","data","setTimeout","catch","err","length","date","Date","createdAt","status","toLocaleDateString","address","orderItems","item","PUBLIC_URL","name","price","total"],"mappings":"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","sourcesContent":["import axios from 'axios'\r\nimport React, { useEffect, useState, useContext } from 'react'\r\nimport Navbar from '../../components/navbar/Navbar'\r\nimport LoadingSpinner from '../../components/spinner/Spinner'\r\nimport { Notyf } from 'notyf';\r\nimport 'notyf/notyf.min.css';\r\nimport { StatusContext } from '../../components/context/StatusContext';\r\n\r\nimport \"./myorder.css\"\r\nimport Status from '../../components/status/Status';\r\nexport default function MyOrders() {\r\n    const [myOrders, setMyOrders] = useState([])\r\n    const [loading, setLoading] = useState(false)\r\n    const statusTab = [\"Waiting confirmation...\", \"cooking...\", \"On the way...\", \"Delivered\"]\r\n  \r\n    const {sock} = useContext(StatusContext)\r\n    console.log(sock);\r\n    //Permet de montrer/cacher les éléments de la commande (nourriture) lors du clique\r\n    const showHideFood = (e, id) => {\r\n        e.preventDefault()\r\n        document.getElementById(id).classList.toggle(\"show-hide\")\r\n    }\r\n    // pour status faire un composant a part avec des props\r\n    // faire un useeffect dans ce composant pour mettre à jour le status\r\n    // ou \r\n    \r\n    useEffect(() => {\r\n        if(!sock){\r\n            return\r\n        }\r\n        sock.on(\"recieve-status\", (state) => {\r\n            setMyOrders((orders) => orders.map((order) => {\r\n                if(order._id === state._id){\r\n                    return state\r\n                }\r\n                return order\r\n            }) )\r\n           \r\n            \r\n           \r\n        })\r\n    }, [sock])\r\n\r\n    \r\n    useEffect(()=> {\r\n        const id = localStorage.getItem(\"userId\")\r\n        const getOrder = async()=> {\r\n            await axios({\r\n                method:\"get\",\r\n                url:`${process.env.REACT_APP_API_URL}order/`+ id ,\r\n                withCredentials: true, \r\n                headers: {\r\n                    'Access-Control-Allow-Credentials': true,\r\n                  }         \r\n            })\r\n            .then((res) => {             \r\n                console.log(res.data.data)\r\n                setMyOrders(res.data.data)\r\n                setTimeout(() => setLoading(true),500)       \r\n            })\r\n            .catch((err) => {\r\n                console.log(err)\r\n            })\r\n        }\r\n      getOrder()\r\n      \r\n    },[])\r\n\r\n   \r\n\r\n    if(loading === false) {\r\n        return <LoadingSpinner />\r\n    }\r\n  return (\r\n      \r\n      <div className='container'>\r\n          <Navbar />\r\n    <div className='orders-container'>\r\n        <div className=\"current-orders orders\">\r\n            <h1 className='title-order'>  <span className='span-color'>Current</span> Orders</h1>\r\n            {myOrders.length === 0 ?  (<p>You don't have any current order </p>) : ( myOrders.map((order)=> {\r\n                const date = new Date(order.createdAt)\r\n            if(order.status !==3){\r\n                return <div className='single-order'>\r\n                    <p className='status-order-current'><span className='status'>Status : </span> {statusTab[order.status]}</p>\r\n                    <p className='date-order'>{date.toLocaleDateString(\"fr\")}</p>\r\n                    <p>Address : {order.address}</p>\r\n                    <button className='show-food'  onClick={(e) => showHideFood(e, order._id)}>Show/hide food</button>\r\n                    <ul className='food-list' id={order._id}>\r\n                    \r\n                        {order.orderItems.map((item)=> {\r\n                           return <li> <img src={process.env.PUBLIC_URL + `/image/${item.name}.png`} alt=\"\" width=\"40\" height=\"40\" /> <span>{item.name}</span> <span>${item.price}</span></li>\r\n                        })}\r\n                    </ul>\r\n                    <p className='total-order-price'>Total : <span className='span-color'>$</span>{order.total}</p>\r\n\r\n                </div>\r\n            }\r\n        })) }\r\n      \r\n        </div>\r\n        <div className=\"old-orders orders\">\r\n        <h1 className='title-order'><span className='span-color'>Old</span> Orders</h1>\r\n        {myOrders.map((order)=> {\r\n            const date = new Date(order.createdAt)\r\n            if(order.status ===3){\r\n                return <div className='single-order'>\r\n                    <p className='status-order-old'><span className='status'>Status :</span>  {statusTab[order.status]}</p>\r\n                    <p className='date-order'>{date.toLocaleDateString(\"fr\")}</p>\r\n                    <p>Address : {order.address}</p>\r\n                    <button  className='show-food' onClick={(e) => showHideFood(e, order._id)}>Show/hide food</button>\r\n                    <ul className='food-list' id={order._id}>\r\n                        \r\n                        {order.orderItems.map((item)=> {\r\n                           return <li> <img src={process.env.PUBLIC_URL + `/image/${item.name}.png`} alt=\"\" width=\"40\" height=\"40\" /> <span>{item.name}</span> <span>${item.price}</span></li>\r\n                        })}\r\n                    </ul>\r\n                    <p className='total-order-price'>Total : <span className='span-color'>$</span>{order.total}</p>\r\n\r\n                </div>\r\n            }\r\n        })}\r\n        </div>\r\n    </div>\r\n    </div>\r\n  )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}